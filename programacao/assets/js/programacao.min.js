/*! =========================================================
 * programacao.min.js
 * ========================================================= */
$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip({trigger:'hover',html:!0,});var collapsed='';var target='';var collapse_count=0;var scroll;var pastCollapsed;if($(document).width()<992){scroll=135}else{scroll=235}
var data=new Date();var dia=data.getDate();var dia_sem=data.getDay();var mes=data.getMonth();var ano2=data.getYear();var ano4=data.getFullYear();var hora=data.getHours();var min=data.getMinutes();var seg=data.getSeconds();var mseg=data.getMilliseconds();var tz=data.getTimezoneOffset();var dias=new Array('DOMINGO','SEGUNDA','TERÇA','QUARTA','QUINTA','SEXTA','SÁBADO');var meses=new Array('JANEIRO','FEVEREITO','MARÇO','ABRIL','MAIO','JUNHO','JULHO','AGOSTO','SETEMBRO','OUTUBRO','NOVEMBRO','DEZEMBRO');var d_s=dias[dia_sem].substring(0,3);var str_data=d_s+', '+dia+' DE '+meses[mes];$('#data').text(str_data);function getGrade(queryData){$('.panel-group').empty();arquivoPath='http://www.tvufg.org.br/grade/pdf/'+queryData+'.pdf';$('#download-grade').attr("href",arquivoPath);$.ajax({url:'get_grade.php',type:"POST",data:{getDia:queryData},beforeSend:function(){$('html, body').animate({scrollTop:$('.wrapper').offset().top-160},200,function(){});$('.panel-group').html('<img style="with: 200px; height: 123.5px; margin-left: calc(50% - 100px); margin-top: 10%;" src="../imagens/loading_tv_ufg.gif"/>')},success:function(resp){setTimeout(function(){if(resp!=""){$('.panel-group').html(resp);$('[data-toggle="tooltip"]').tooltip({trigger:'hover',html:!0,});$(".collapse-programa").on('click',function(){if(pastCollapsed!=$(this).closest('.collapse-programa').attr('href')){$(pastCollapsed).collapse('hide');pastCollapsed=$(this).closest('.collapse-programa').attr('href')}
if($(this).closest('.panel-default').css("background-color")=='rgb(242, 242, 242)'){$(this).closest('.panel-default').css("background-color","#f9f9f9")}else{$($(this).closest('.panel-default')).on('show.bs.collapse',function(){$(collapsed).css("background-color","#f9f9f9");collapsed=$(this).closest('.panel-default');$(collapsed).css("background-color","#f2f2f2")})}});$('.stop').on("click",function(){if(target!=''){var selector="[target-iframe="+target+"]";$(selector).attr('src',$(selector).attr('src'));target=$(this).attr("data-iframe");collapse_count++}else{target=$(this).attr("data-iframe");collapse_count++}});function compararHora(hora1,hora2){hora1=hora1.split(":");hora2=hora2.split(":");var d=new Date();var data1=new Date(d.getFullYear(),d.getMonth(),d.getDate(),hora1[0],hora1[1]);var data2=new Date(d.getFullYear(),d.getMonth(),d.getDate(),hora2[0],hora2[1]);return data1>data2};var horas=[];function noAR(){$.each($(".time"),function(){horas.push($(this).text())});hora=data.getHours();min=data.getMinutes();var stringHoraPC=hora+":"+min;var stringHoraPG;if(compararHora(horas[0],stringHoraPC)==!0){return horas.length-1}
for(i=1;i<horas.length;i++){stringHoraPG=horas[i];if(compararHora(stringHoraPG,stringHoraPC)==!0){return i-1}}
if(i==horas.length){return i-1}}
if(stringDataAtual==queryData){var retorno=noAR();if(retorno>=0){var noARPG=horas[retorno];$.each($(".time"),function(){if($(this).text()==noARPG){pastCollapsed=$(this).closest('.collapse-programa').attr('href');target=$(this).closest('.collapse-programa').attr('data-iframe');collapsed=$(this).closest('.panel-default');$(collapsed).css("background-color","#f2f2f2");$(this).replaceWith('<span class="no-ar">NO AR</span>');$(pastCollapsed).collapse('show');collapse_count++}});setTimeout(function(){$('html, body').animate({scrollTop:$(pastCollapsed).offset().top-scroll},1500,function(){})},350)}}}else{$('.panel-group').html('<div style="margin-top: 20%;"> <h2 style="text-align: center; font-family: opensans-light,Arial,sans-serif !important; font-weight: 700;">Não há itens para exibição</h2> </div>')}},1200)}})}
if(dia<10){dia="0"+dia}
if(mes<10){mes="0"+(mes+1)}
var queryData=ano4+mes+dia;var stringDataAtual=ano4+mes+dia;getGrade(queryData);var nextdata=new Date;nextdata.setDate(nextdata.getDate()+1);nextdia=nextdata.getDate();nextmes=nextdata.getMonth();nextd_s=dias[nextdata.getDay()].substring(0,3);nextano4=nextdata.getFullYear();if(nextdia<10){nextdia="0"+nextdia}
if(nextmes<10){nextmes="0"+(nextmes+1)}
var queryNextData=nextano4+nextmes+nextdia;$.ajax({url:'ultima_data.php',type:"POST",data:{getDia:queryNextData},success:function(resp){if(resp==-1){$("#nextDay").attr('disabled','disabled');$("#nextDay").addClass('disabled')}else{$('#nextDay').removeAttr('disabled');$("#nextDay").removeClass('disabled')}}});$('#lastDay').on('click',function(){data.setDate(data.getDate()-1);dia=data.getDate();mes=data.getMonth();d_s=dias[data.getDay()].substring(0,3);ano4=data.getFullYear();str_data=d_s+', '+dia+' DE '+meses[mes];$('#data').text(str_data);$('#nextDay').removeAttr('disabled');$("#nextDay").removeClass('disabled');if(dia<10){dia="0"+dia}
if(mes<10){mes="0"+(mes+1)}
var queryData=ano4+mes+dia;getGrade(queryData);var lastdata=new Date;lastdata.setDate(data.getDate()-1);lastdia=lastdata.getDate();lastmes=lastdata.getMonth();lastd_s=dias[lastdata.getDay()].substring(0,3);lastano4=lastdata.getFullYear();if(lastdia<10){lastdia="0"+lastdia}
if(lastmes<10){lastmes="0"+(lastmes+1)}
var queryLastData=lastano4+lastmes+lastdia;$.ajax({url:'ultima_data.php',type:"POST",data:{getDia:queryLastData},success:function(resp){if(resp==-1){$("#lastDay").attr('disabled','disabled');$("#lastDay").addClass('disabled')}else{$('#lastDay').removeAttr('disabled');$("#lastDay").removeClass('disabled')}}})});$('#nextDay').on('click',function(){data.setDate(data.getDate()+1);dia=data.getDate();mes=data.getMonth();d_s=dias[data.getDay()].substring(0,3);ano4=data.getFullYear();str_data=d_s+', '+dia+' DE '+meses[mes];$('#data').text(str_data);$('#lastDay').removeAttr('disabled');$("#lastDay").removeClass('disabled');if(dia<10){dia="0"+dia}
if(mes<10){mes="0"+(mes+1)}
var queryData=ano4+mes+dia;getGrade(queryData);var nextdata=new Date;nextdata.setDate(data.getDate()+1);nextdia=nextdata.getDate();nextmes=nextdata.getMonth();nextd_s=dias[nextdata.getDay()].substring(0,3);nextano4=nextdata.getFullYear();if(nextdia<10){nextdia="0"+nextdia}
if(nextmes<10){nextmes="0"+(nextmes+1)}
var queryNextData=nextano4+nextmes+nextdia;$.ajax({url:'ultima_data.php',type:"POST",data:{getDia:queryNextData},success:function(resp){if(resp==-1){$("#nextDay").attr('disabled','disabled');$("#nextDay").addClass('disabled')}else{$('#nextDay').removeAttr('disabled');$("#nextDay").removeClass('disabled')}}})})})
